generate_cumulative_cap